import{G as M,V as u,P as U,W as O,T as N,R as _,S as F,M as A,a as G,A as $,b as q,c as V,d as X,e as K,B as C}from"./vendor.d3fe6867.js";const Z=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const p of a.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&o(p)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerpolicy&&(a.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?a.credentials="include":i.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}};Z();const J=new M;class Q{constructor(e){J.load("/../myassets/models/watercraft/scene.gltf",n=>{e.add(n.scene),n.scene.scale.set(.5,.5,.5),n.scene.position.set(0,-5,0),this.boatobj=n.scene,this.spatial={velocity:0,rot:0}})}update(e){this.boatobj&&(this.boatobj.rotation.y+=this.spatial.rot,this.boatobj.translateZ(this.spatial.velocity),this.boatobj.position.y=.5*Math.sin(2*e)-3.5)}}let x,g,y;function Y(){x=new u;const t=new U(1e4,1e4);g=new O(t,{textureWidth:512,textureHeight:512,waterNormals:new N().load("myassets/textures/waternormals.jpg",function(a){a.wrapS=a.wrapT=_}),sunDirection:new u,sunColor:16777215,waterColor:7695,distortionScale:3.7}),g.rotation.x=-Math.PI/2,y=new F,y.scale.setScalar(1e4);const e=y.material.uniforms;e.turbidity.value=10,e.rayleigh.value=2,e.mieCoefficient.value=.005,e.mieDirectionalG.value=.8;const n={elevation:2,azimuth:180},o=A.degToRad(90-n.elevation),i=A.degToRad(n.azimuth);x.setFromSphericalCoords(1,o,i),y.material.uniforms.sunPosition.value.copy(x),g.material.uniforms.sunDirection.value.copy(x).normalize()}Y();let d,l,h;function ee(){h=new G({antialias:!0}),h.setPixelRatio(window.devicePixelRatio),h.setSize(window.innerWidth,window.innerHeight),h.toneMapping=$,document.body.appendChild(h.domElement),l=new q,d=new V(55,window.innerWidth/window.innerHeight,1,2e3),d.position.set(30,30,100)}ee();let w=!1,k="follow",T=!1;function te(t){const e=document.getElementById("blocker"),n=document.getElementById("instructions");n.addEventListener("click",o=>{n.style.display="none",e.style.display="none",w=!0}),window.addEventListener("resize",oe),window.addEventListener("keydown",o=>{o.key=="Escape"&&(e.style.display="block",n.style.display="",w=!1),w&&(o.key=="w"&&(t.spatial.velocity=4),o.key=="s"&&(t.spatial.velocity=-4),o.key=="a"&&(t.spatial.rot=.04),o.key=="d"&&(t.spatial.rot=-.04),o.key=="c"&&(k=="follow"?k="top":k="follow"),o.key==" "&&(T=!0))}),window.addEventListener("keyup",o=>{w&&(o.key=="w"&&(t.spatial.velocity=0),o.key=="s"&&(t.spatial.velocity=0),o.key=="a"&&(t.spatial.rot=0),o.key=="d"&&(t.spatial.rot=0),o.key==" "&&(T=!1))})}function oe(){d.aspect=window.innerWidth/window.innerHeight,d.updateProjectionMatrix(),h.setSize(window.innerWidth,window.innerHeight)}let B;function ie(){B=new X,document.body.appendChild(B.dom)}ie();const ne=new M;class v{constructor(e,n,o){ne.load("../myassets/models/treasure/scene.gltf",i=>{e.add(i.scene),i.scene.scale.set(1,1,1),i.scene.position.set(n,8,o),this.treasureobj=i.scene,this.spatial={rot:.04}})}update(e){this.treasureobj&&(this.treasureobj.rotation.y+=this.spatial.rot,this.treasureobj.position.y=2*Math.sin(2*e+1)+8)}}const se=new M;class ae{constructor(e,n,o,i){se.load("../myassets/models/treasure/scene.gltf",a=>{e.add(a.scene),a.scene.scale.set(.5,.5,.5),a.scene.rotation.x=Math.PI/2,a.scene.rotation.z=-i,a.scene.position.set(n,6.5,o),this.bulletobj=a.scene,this.spatial={vel:30},this.initialpositioning()})}initialpositioning(){const e=new u;this.bulletobj.children[0].getWorldDirection(e),this.bulletobj.position.add(e.multiplyScalar(this.spatial.vel))}update(e){if(this.bulletobj){const n=new u;this.bulletobj.children[0].getWorldDirection(n),this.bulletobj.position.add(n.multiplyScalar(this.spatial.vel)),this.bulletobj.position.y=.5*Math.sin(2*e)+6.5}}}const le=new M;class E{constructor(e,n,o){le.load("../myassets/models/enemy/scene.gltf",i=>{e.add(i.scene),i.scene.scale.set(8,8,8),i.scene.position.set(n,5,o),this.enemyobj=i.scene,this.spatial={velocity:4,rot:0}})}update(e,n){if(this.enemyobj&&e){if(this.enemyobj.lookAt(e.position),w){const o=new u;this.enemyobj.children[0].getWorldDirection(o),this.enemyobj.position.add(o.multiplyScalar(this.spatial.velocity))}this.enemyobj.position.y=.5*Math.sin(2*n)+2}}}const re=new M;class ce{constructor(e,n,o,i,a){re.load("../myassets/models/ebullet/scene.gltf",p=>{e.add(p.scene),p.scene.scale.set(.1,.1,.1),p.scene.position.set(n,-2,o),this.ebullobj=p.scene,this.spatial={vel:400},this.initialpositioning(a)})}initialpositioning(e){this.ebullobj.lookAt(e.position)}update(e){if(this.ebullobj){const n=new u;this.ebullobj.children[0].getWorldDirection(n),this.ebullobj.position.add(n.normalize().multiplyScalar(this.spatial.vel)),this.ebullobj.position.y=.5*Math.sin(2*e)+0}}}let f,s=new Q(l),j=100,r=[],m=[],z=0,c=[],b=[],L=0,R=0,I=3,D=4,S=10;const de=document.getElementById("gameover"),pe=document.getElementById("mytext"),be=document.getElementById("HUDtext");ue();H();function ue(){for(l.add(g),l.add(y),l.environment=new K(h).fromScene(y).texture,te(s);r.length<D;)r.push(new v(l,100+Math.random()*100,100+Math.random()*100)),r.push(new v(l,-100-Math.random()*100,100+Math.random()*100)),r.push(new v(l,100+Math.random()*100,-100-Math.random()*100)),r.push(new v(l,-100-Math.random()*100,-100-Math.random()*100));for(;c.length<I;)c.push(new E(l,100+Math.random()*50,100+Math.random()*30)),c.push(new E(l,-100-Math.random()*50,100+Math.random()*30)),c.push(new E(l,100+Math.random()*50,-100-Math.random()*30))}function H(){requestAnimationFrame(H),g.material.uniforms.time.value+=1/60,f=performance.now()*.001,he(),h.render(l,d)}function he(){B.update(),s.update(f);for(var t of r)t.update(f);for(;r.length<D;)r.push(new v(l,s.boatobj.position.x+70+Math.random()*200,s.boatobj.position.z+50+Math.random()*200));for(var e of c)e.update(s.boatobj,f);for(;c.length<I;)c.push(new E(l,s.boatobj.position.x+70+Math.random()*200,s.boatobj.position.z+50+Math.random()*200));if(me(),s.boatobj)if(k=="follow"){var n=new u(0,30,-110),o=n.applyMatrix4(s.boatobj.matrixWorld);d.position.x=o.x,d.position.y=o.y,d.position.z=o.z,d.lookAt(new u(s.boatobj.position.x,s.boatobj.position.y+10,s.boatobj.position.z))}else{var n=new u(0,500,-25),o=n.applyMatrix4(s.boatobj.matrixWorld);d.position.x=o.x,d.position.y=o.y,d.position.z=o.z,d.lookAt(new u(s.boatobj.position.x,s.boatobj.position.y,s.boatobj.position.z))}T?z++:z=0,z==1&&s.boatobj&&S>0&&(console.log("shooting"),S--,m.push(new ae(l,s.boatobj.position.x,s.boatobj.position.z,s.boatobj.rotation.y)));for(var i of m)if(i.update(f),i.bulletobj&&s.boatobj){let P=new u;P.copy(i.bulletobj.position),P.sub(s.boatobj.position).length()>1e3&&(l.remove(i.bulletobj),m.splice(m.indexOf(i),1))}if(Math.floor(f)%10==0){if(L++,L==1){for(var a of b)l.remove(a.ebullobj);for(var p=0;p<b.length;p++)b.splice(p,1);for(var e of c)e.enemyobj&&s.boatobj&&b.push(new ce(l,e.enemyobj.position.x,e.enemyobj.position.z,e.enemyobj.rotation.y,s.boatobj))}}else L=0;for(var a of b)a.update(f);j<=0&&(de.style.display="block",pe.style.display=""),be.innerHTML="Health: "+j+" | SCORE: "+R+" | Ammo: "+S}function me(){if(s.boatobj){for(let t=0;t<r.length;t++)if(r[t].treasureobj&&W(s.boatobj.children[0],s.boatobj.position,r[t].treasureobj.children[0],r[t].treasureobj.position)){console.log("Treasure collected",t),S+=5,l.remove(r[t].treasureobj),r.splice(t,1);break}}for(let t=0;t<m.length;t++)if(m[t].bulletobj){for(let e=0;e<c.length;e++)if(c[e].enemyobj&&W(m[t].bulletobj.children[0],m[t].bulletobj.position,c[e].enemyobj.children[0],c[e].enemyobj.position)){console.log("enemy shot",t),R+=1,l.remove(c[e].enemyobj),c.splice(e,1);break}}for(let t=0;t<b.length;t++)if(b[t].ebullobj&&s.boatobj&&W(b[t].ebullobj.children[0],b[t].ebullobj.position,s.boatobj.children[0],s.boatobj.position)){j>0&&(j=j-10),console.log("HIT",j),l.remove(b[t].ebullobj),b.splice(t,1);break}}function W(t,e,n,o){const i=new C().setFromObject(t),a=new C().setFromObject(n);return o.distanceTo(e)<20&&i.intersectsBox(a)}
